<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>×—×“ ×’×“×™× - Had Gadya: The Passover Game</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Verse Display During Gameplay (above game) -->
    <div id="gameplay-verse"></div>
    
    <div id="game-container">
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        
        <!-- HUD Overlay -->
        <div id="hud">
            <div id="awakeness-container">
                <span>ğŸ˜´ Awakeness:</span>
                <div id="awakeness-bar">
                    <div id="awakeness-fill"></div>
                </div>
                <span id="awakeness-percent">100%</span>
            </div>
            <div id="timers">
                <div id="level-timer">ğŸ¯ Level: <span id="level-time-display">00:00.00</span></div>
                <div id="total-timer">â±ï¸ Total: <span id="time-display">00:00.00</span></div>
            </div>
            <div id="level-display">Level: <span id="current-level">1</span>/10</div>
        </div>
    </div>

    <!-- Mobile Touch Controls -->
    <div id="mobile-controls" class="hidden">
        <div id="dpad">
            <button id="touch-up" class="dpad-btn">â¬†ï¸</button>
            <div id="dpad-middle">
                <button id="touch-left" class="dpad-btn">â¬…ï¸</button>
                <button id="touch-action" class="dpad-btn action-btn">ğŸ¯</button>
                <button id="touch-right" class="dpad-btn">â¡ï¸</button>
            </div>
            <button id="touch-down" class="dpad-btn">â¬‡ï¸</button>
        </div>
    </div>

    <!-- Game Controls (Outside Play Area) -->
    <div id="game-controls" class="hidden">
        <button id="home-btn" class="control-btn">ğŸ  Home</button>
        <button id="pause-btn" class="control-btn">â¸ï¸ Pause</button>
        <button id="reset-btn" class="control-btn">ğŸ”„ Reset Level</button>
    </div>

    <!-- Main Menu -->
    <div id="main-menu" class="menu-screen">
        <h1>ğŸ ×—×“ ×’×“×™× ğŸ</h1>
        <div class="menu-buttons">
            <button id="start-game-btn" class="menu-btn">ğŸ® Start Game</button>
            <button id="level-select-btn" class="menu-btn">ğŸ“‹ Practice Level</button>
            <button id="high-scores-btn" class="menu-btn">ğŸ† High Scores</button>
            <button id="how-to-play-btn" class="menu-btn">â“ How To Play</button>
        </div>
        <p class="credits">A Passover Game for the Whole Family ğŸ·</p>
        <p class="version">v1.3.0 â€¢ Build Dec 20, 2025</p>
    </div>

    <!-- Level Select -->
    <div id="level-select" class="menu-screen hidden">
        <h2>ğŸ“‹ Practice Level</h2>
        <div id="difficulty-selector" class="difficulty-selector">
            <span>Difficulty:</span>
            <button class="difficulty-btn" data-difficulty="easy">ğŸ˜Š Easy</button>
            <button class="difficulty-btn active" data-difficulty="normal">ğŸ˜ Normal</button>
            <button class="difficulty-btn" data-difficulty="hard">ğŸ˜¤ Hard</button>
            <button class="difficulty-btn" data-difficulty="extreme">ğŸ’€ Extreme</button>
        </div>
        <div id="level-grid"></div>
        <button id="back-to-menu-btn" class="menu-btn">â¬…ï¸ Back to Menu</button>
    </div>

    <!-- How To Play -->
    <div id="how-to-play" class="menu-screen hidden">
        <h2>â“ How To Play</h2>
        <div class="instructions">
            <p>ğŸ¯ <strong>Goal:</strong> Complete all 10 levels of Had Gadya before your Awakeness runs out!</p>
            <p>âŒ¨ï¸ <strong>Controls:</strong> Arrow keys/WASD to move. Space/Enter for actions. Touch controls on mobile!</p>
            <p>ğŸ˜´ <strong>Awakeness:</strong> Your awakeness slowly decreases. Find ğŸ«“ Matzah to stay awake!</p>
            <p>â­ <strong>Stars:</strong> Complete levels quickly to earn up to 3 stars!</p>
            <p>ğŸ† <strong>Speedrun:</strong> Try to beat all levels as fast as possible!</p>
        </div>
        <button id="back-from-help-btn" class="menu-btn">â¬…ï¸ Back to Menu</button>
    </div>

    <!-- Level Intro -->
    <div id="level-intro" class="menu-screen hidden">
        <h2 id="level-title"></h2>
        <div id="level-verse" class="verse-box"></div>
        <p id="level-description"></p>
        <p id="level-instructions"></p>
        <button id="start-level-btn" class="menu-btn">â–¶ï¸ Start Level</button>
    </div>

    <!-- Level Complete -->
    <div id="level-complete" class="menu-screen hidden">
        <h2>ğŸ‰ Level Complete!</h2>
        <div id="level-stats">
            <p>Time: <span id="complete-time"></span></p>
            <p>Stars: <span id="complete-stars"></span></p>
        </div>
        <div class="menu-buttons">
            <button id="next-level-btn" class="menu-btn">â¡ï¸ Next Level</button>
            <button id="replay-level-btn" class="menu-btn">ğŸ”„ Replay</button>
            <button id="complete-to-menu-btn" class="menu-btn">ğŸ  Menu</button>
        </div>
    </div>

    <!-- Game Over (Fell Asleep) -->
    <div id="game-over" class="menu-screen hidden">
        <h2>ğŸ˜´ğŸ’¤ You Fell Asleep!</h2>
        <p id="game-over-reason" style="font-size: 1.1em; color: #ffcc00; margin: 15px 0;">The Seder was just too long...</p>
        <p>Total Time: <span id="game-over-time"></span></p>
        <div class="menu-buttons">
            <button id="retry-btn" class="menu-btn">ğŸ”„ Try Again</button>
            <button id="game-over-menu-btn" class="menu-btn">ğŸ  Menu</button>
        </div>
    </div>

    <!-- Victory Screen -->
    <div id="victory" class="menu-screen hidden">
        <h2>ğŸ† ×—×’ ×©××—! You Won! ğŸ†</h2>
        <p>You completed the Had Gadya before falling asleep!</p>
        <p>Total Time: <span id="victory-time"></span></p>
        <p>Total Stars: <span id="victory-stars"></span>/30</p>
        <p id="new-high-score-msg" class="hidden" style="color: gold; font-size: 1.3em;">ğŸŒŸ NEW HIGH SCORE! ğŸŒŸ</p>
        <div id="name-input-container" class="hidden" style="margin: 15px 0;">
            <label for="player-name-input" style="margin-right: 10px;">Enter your name:</label>
            <input type="text" id="player-name-input" maxlength="20" placeholder="Your Name" style="padding: 8px; font-size: 1em; border-radius: 5px; border: 2px solid gold;">
            <button id="submit-score-btn" class="menu-btn" style="margin-left: 10px; padding: 8px 15px;">Submit</button>
        </div>
        <div class="menu-buttons">
            <button id="victory-menu-btn" class="menu-btn">ğŸ  Menu</button>
        </div>
    </div>

    <!-- High Scores Screen -->
    <div id="high-scores" class="menu-screen hidden">
        <h2>ğŸ† High Scores</h2>
        <div id="high-scores-difficulty" class="difficulty-selector" style="margin-bottom: 20px;">
            <button class="difficulty-btn" data-hs-difficulty="easy">ğŸ˜Š Easy</button>
            <button class="difficulty-btn active" data-hs-difficulty="normal">ğŸ˜ Normal</button>
            <button class="difficulty-btn" data-hs-difficulty="hard">ğŸ˜¤ Hard</button>
            <button class="difficulty-btn" data-hs-difficulty="extreme">ğŸ’€ Extreme</button>
        </div>
        <div id="high-scores-list" style="background: rgba(0,0,0,0.5); padding: 20px; border-radius: 10px; max-width: 500px; margin: 0 auto;">
            <p style="text-align: center; color: #888;">Loading...</p>
        </div>
        <button id="back-from-scores-btn" class="menu-btn" style="margin-top: 20px;">â¬…ï¸ Back to Menu</button>
    </div>

    <!-- Start Game Dialog (Difficulty Selection Only) -->
    <div id="start-game-dialog" class="menu-screen hidden">
        <h2>ğŸ Ready to Play? ğŸ</h2>
        <p class="subtitle" style="font-size: 1.2em; color: #ffd700; margin: 15px 0;">How fast can you complete the game so we can get on with the Seder?</p>
        <div id="start-difficulty-selector" class="difficulty-selector" style="margin: 25px 0;">
            <span>Difficulty:</span>
            <button class="difficulty-btn start-diff-btn" data-difficulty="easy">ğŸ˜Š Easy</button>
            <button class="difficulty-btn start-diff-btn active" data-difficulty="normal">ğŸ˜ Normal</button>
            <button class="difficulty-btn start-diff-btn" data-difficulty="hard">ğŸ˜¤ Hard</button>
            <button class="difficulty-btn start-diff-btn" data-difficulty="extreme">ğŸ’€ Extreme</button>
        </div>
        <div class="menu-buttons">
            <button id="start-game-go-btn" class="menu-btn" style="font-size: 1.3em; padding: 15px 40px;">â–¶ï¸ Start!</button>
            <button id="start-game-back-btn" class="menu-btn">â¬…ï¸ Back to Menu</button>
        </div>
    </div>

    <!-- Battle UI (for Pokemon-style battles) -->
    <div id="battle-ui" class="hidden">
        <div id="player-battle-info" class="battle-info">
            <span id="player-name">Player</span>
            <div class="hp-bar"><div id="player-hp"></div></div>
        </div>
        <div id="enemy-battle-info" class="battle-info">
            <span id="enemy-name">Enemy</span>
            <div class="hp-bar"><div id="enemy-hp"></div></div>
        </div>
        <div id="battle-menu">
            <div id="battle-moves"></div>
            <div id="battle-message"></div>
        </div>
    </div>

    <script src=\"js/supabase.js?v=4\"></script>
    <script src=\"js/audio.js?v=4\"></script>
    <script src=\"js/engine.js?v=4\"></script>
    <script src=\"js/vs-splash.js?v=4\"></script>
    <script src=\"js/levels/level1.js?v=4\"></script>
    <script src=\"js/levels/level2.js?v=4\"></script>
    <script src=\"js/levels/level3.js?v=4\"></script>
    <script src=\"js/levels/level4.js?v=4\"></script>
    <script src=\"js/levels/level5.js?v=4\"></script>
    <script src=\"js/levels/level6.js?v=4\"></script>
    <script src=\"js/levels/level7.js?v=4\"></script>
    <script src=\"js/levels/level8.js?v=4\"></script>
    <script src=\"js/levels/level9.js?v=4\"></script>
    <script src=\"js/levels/level10.js?v=4\"></script>
    <script src=\"js/levels/bonus.js?v=4\"></script>
    <script src=\"js/game.js?v=4\"></script>
</body>
</html>
